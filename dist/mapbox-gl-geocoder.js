!function t(e,n,r){function i(u,c){if(!n[u]){if(!e[u]){var s="function"==typeof require&&require;if(!c&&s)return s(u,!0);if(o)return o(u,!0);var a=new Error("Cannot find module '"+u+"'");throw a.code="MODULE_NOT_FOUND",a}var f=n[u]={exports:{}};e[u][0].call(f.exports,function(t){var n=e[u][1][t];return i(n?n:t)},f,f.exports,t,e,n,r)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){return new u["default"](t)}var o=t("./src/geocoder"),u=r(o);window.mapboxgl?mapboxgl.Geocoder=i:"undefined"!=typeof e&&(e.exports=i)},{"./src/geocoder":75}],2:[function(t,e,n){function r(t,e){return d.isUndefined(e)?""+e:d.isNumber(e)&&!isFinite(e)?e.toString():d.isFunction(e)||d.isRegExp(e)?e.toString():e}function i(t,e){return d.isString(t)?t.length<e?t:t.slice(0,e):t}function o(t){return i(JSON.stringify(t.actual,r),128)+" "+t.operator+" "+i(JSON.stringify(t.expected,r),128)}function u(t,e,n,r,i){throw new m.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function c(t,e){t||u(t,!0,e,"==",m.ok)}function s(t,e){if(t===e)return!0;if(d.isBuffer(t)&&d.isBuffer(e)){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return d.isDate(t)&&d.isDate(e)?t.getTime()===e.getTime():d.isRegExp(t)&&d.isRegExp(e)?t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase:d.isObject(t)||d.isObject(e)?f(t,e):t==e}function a(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function f(t,e){if(d.isNullOrUndefined(t)||d.isNullOrUndefined(e))return!1;if(t.prototype!==e.prototype)return!1;if(d.isPrimitive(t)||d.isPrimitive(e))return t===e;var n=a(t),r=a(e);if(n&&!r||!n&&r)return!1;if(n)return t=h.call(t),e=h.call(e),s(t,e);var i,o,u=v(t),c=v(e);if(u.length!=c.length)return!1;for(u.sort(),c.sort(),o=u.length-1;o>=0;o--)if(u[o]!=c[o])return!1;for(o=u.length-1;o>=0;o--)if(i=u[o],!s(t[i],e[i]))return!1;return!0}function l(t,e){return t&&e?"[object RegExp]"==Object.prototype.toString.call(e)?e.test(t):t instanceof e?!0:e.call({},t)===!0?!0:!1:!1}function p(t,e,n,r){var i;d.isString(n)&&(r=n,n=null);try{e()}catch(o){i=o}if(r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&u(i,n,"Missing expected exception"+r),!t&&l(i,n)&&u(i,n,"Got unwanted exception"+r),t&&i&&n&&!l(i,n)||!t&&i)throw i}var d=t("util/"),h=Array.prototype.slice,y=Object.prototype.hasOwnProperty,m=e.exports=c;m.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=o(this),this.generatedMessage=!0);var e=t.stackStartFunction||u;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=e.name,c=r.indexOf("\n"+i);if(c>=0){var s=r.indexOf("\n",c+1);r=r.substring(s+1)}this.stack=r}}},d.inherits(m.AssertionError,Error),m.fail=u,m.ok=c,m.equal=function(t,e,n){t!=e&&u(t,e,n,"==",m.equal)},m.notEqual=function(t,e,n){t==e&&u(t,e,n,"!=",m.notEqual)},m.deepEqual=function(t,e,n){s(t,e)||u(t,e,n,"deepEqual",m.deepEqual)},m.notDeepEqual=function(t,e,n){s(t,e)&&u(t,e,n,"notDeepEqual",m.notDeepEqual)},m.strictEqual=function(t,e,n){t!==e&&u(t,e,n,"===",m.strictEqual)},m.notStrictEqual=function(t,e,n){t===e&&u(t,e,n,"!==",m.notStrictEqual)},m["throws"]=function(t,e,n){p.apply(this,[!0].concat(h.call(arguments)))},m.doesNotThrow=function(t,e){p.apply(this,[!1].concat(h.call(arguments)))},m.ifError=function(t){if(t)throw t};var v=Object.keys||function(t){var e=[];for(var n in t)y.call(t,n)&&e.push(n);return e}},{"util/":6}],3:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],4:[function(t,e,n){function r(){f=!1,c.length?a=c.concat(a):l=-1,a.length&&i()}function i(){if(!f){var t=setTimeout(r);f=!0;for(var e=a.length;e;){for(c=a,a=[];++l<e;)c&&c[l].run();l=-1,e=a.length}c=null,f=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function u(){}var c,s=e.exports={},a=[],f=!1,l=-1;s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new o(t,e)),1!==a.length||f||setTimeout(i,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=u,s.addListener=u,s.once=u,s.off=u,s.removeListener=u,s.removeAllListeners=u,s.emit=u,s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],5:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],6:[function(t,e,n){(function(e,r){function i(t,e){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(e)?r.showHidden=e:e&&n._extend(r,e),x(r.showHidden)&&(r.showHidden=!1),x(r.depth)&&(r.depth=2),x(r.colors)&&(r.colors=!1),x(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),s(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function u(t,e){return t}function c(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function s(t,e,r){if(t.customInspect&&e&&T(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return b(i)||(i=s(t,i,r)),i}var o=a(t,e);if(o)return o;var u=Object.keys(e),y=c(u);if(t.showHidden&&(u=Object.getOwnPropertyNames(e)),O(e)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return f(e);if(0===u.length){if(T(e)){var m=e.name?": "+e.name:"";return t.stylize("[Function"+m+"]","special")}if(_(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(E(e))return t.stylize(Date.prototype.toString.call(e),"date");if(O(e))return f(e)}var v="",g=!1,w=["{","}"];if(h(e)&&(g=!0,w=["[","]"]),T(e)){var x=e.name?": "+e.name:"";v=" [Function"+x+"]"}if(_(e)&&(v=" "+RegExp.prototype.toString.call(e)),E(e)&&(v=" "+Date.prototype.toUTCString.call(e)),O(e)&&(v=" "+f(e)),0===u.length&&(!g||0==e.length))return w[0]+v+w[1];if(0>r)return _(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var j;return j=g?l(t,e,r,y,u):u.map(function(n){return p(t,e,r,y,n,g)}),t.seen.pop(),d(j,v,w)}function a(t,e){if(x(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return g(e)?t.stylize(""+e,"number"):y(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):void 0}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function l(t,e,n,r,i){for(var o=[],u=0,c=e.length;c>u;++u)P(e,String(u))?o.push(p(t,e,n,r,String(u),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(t,e,n,r,i,!0))}),o}function p(t,e,n,r,i,o){var u,c,a;if(a=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},a.get?c=a.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):a.set&&(c=t.stylize("[Setter]","special")),P(r,i)||(u="["+i+"]"),c||(t.seen.indexOf(a.value)<0?(c=m(n)?s(t,a.value,null):s(t,a.value,n-1),c.indexOf("\n")>-1&&(c=o?c.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+c.split("\n").map(function(t){return"   "+t}).join("\n"))):c=t.stylize("[Circular]","special")),x(u)){if(o&&i.match(/^\d+$/))return c;u=JSON.stringify(""+i),u.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(u=u.substr(1,u.length-2),u=t.stylize(u,"name")):(u=u.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),u=t.stylize(u,"string"))}return u+": "+c}function d(t,e,n){var r=0,i=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function h(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function m(t){return null===t}function v(t){return null==t}function g(t){return"number"==typeof t}function b(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function x(t){return void 0===t}function _(t){return j(t)&&"[object RegExp]"===S(t)}function j(t){return"object"==typeof t&&null!==t}function E(t){return j(t)&&"[object Date]"===S(t)}function O(t){return j(t)&&("[object Error]"===S(t)||t instanceof Error)}function T(t){return"function"==typeof t}function A(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function S(t){return Object.prototype.toString.call(t)}function k(t){return 10>t?"0"+t.toString(10):t.toString(10)}function C(){var t=new Date,e=[k(t.getHours()),k(t.getMinutes()),k(t.getSeconds())].join(":");return[t.getDate(),I[t.getMonth()],e].join(" ")}function P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var R=/%[sdj%]/g;n.format=function(t){if(!b(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,o=r.length,u=String(t).replace(R,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}}),c=r[n];o>n;c=r[++n])u+=m(c)||!j(c)?" "+c:" "+i(c);return u},n.deprecate=function(t,i){function o(){if(!u){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),u=!0}return t.apply(this,arguments)}if(x(r.process))return function(){return n.deprecate(t,i).apply(this,arguments)};if(e.noDeprecation===!0)return t;var u=!1;return o};var q,D={};n.debuglog=function(t){if(x(q)&&(q=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!D[t])if(new RegExp("\\b"+t+"\\b","i").test(q)){var r=e.pid;D[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,r,e)}}else D[t]=function(){};return D[t]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=h,n.isBoolean=y,n.isNull=m,n.isNullOrUndefined=v,n.isNumber=g,n.isString=b,n.isSymbol=w,n.isUndefined=x,n.isRegExp=_,n.isObject=j,n.isDate=E,n.isError=O,n.isFunction=T,n.isPrimitive=A,n.isBuffer=t("./support/isBuffer");var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",C(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!j(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":5,_process:4,inherits:3}],7:[function(t,e,n){function r(t,e,n){for(var r=-1,i=u(e),o=i.length;++r<o;){var c=i[r],s=t[c],a=n(s,e[c],c,t,e);(a===a?a===s:s!==s)&&(void 0!==s||c in t)||(t[c]=a)}return t}var i=t("lodash._baseassign"),o=t("lodash._createassigner"),u=t("lodash.keys"),c=o(function(t,e,n){return n?r(t,e,n):i(t,e)});e.exports=c},{"lodash._baseassign":8,"lodash._createassigner":10,"lodash.keys":14}],8:[function(t,e,n){function r(t,e){return null==e?t:i(e,o(e),t)}var i=t("lodash._basecopy"),o=t("lodash.keys");e.exports=r},{"lodash._basecopy":9,"lodash.keys":14}],9:[function(t,e,n){function r(t,e,n){n||(n={});for(var r=-1,i=e.length;++r<i;){var o=e[r];n[o]=t[o]}return n}e.exports=r},{}],10:[function(t,e,n){function r(t){return u(function(e,n){var r=-1,u=null==e?0:n.length,c=u>2?n[u-2]:void 0,s=u>2?n[2]:void 0,a=u>1?n[u-1]:void 0;for("function"==typeof c?(c=i(c,a,5),u-=2):(c="function"==typeof a?a:void 0,u-=c?1:0),s&&o(n[0],n[1],s)&&(c=3>u?void 0:c,u=1);++r<u;){var f=n[r];f&&t(e,f,c)}return e})}var i=t("lodash._bindcallback"),o=t("lodash._isiterateecall"),u=t("lodash.restparam");e.exports=r},{"lodash._bindcallback":11,"lodash._isiterateecall":12,"lodash.restparam":13}],11:[function(t,e,n){function r(t,e,n){if("function"!=typeof t)return i;if(void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)};case 5:return function(n,r,i,o,u){return t.call(e,n,r,i,o,u)}}return function(){return t.apply(e,arguments)}}function i(t){return t}e.exports=r},{}],12:[function(t,e,n){function r(t){return function(e){return null==e?void 0:e[t]}}function i(t){return null!=t&&c(l(t))}function o(t,e){return t="number"==typeof t||a.test(t)?+t:-1,e=null==e?f:e,t>-1&&t%1==0&&e>t}function u(t,e,n){if(!s(n))return!1;var r=typeof e;if("number"==r?i(n)&&o(e,n.length):"string"==r&&e in n){var u=n[e];return t===t?t===u:u!==u}return!1}function c(t){return"number"==typeof t&&t>-1&&t%1==0&&f>=t}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var a=/^\d+$/,f=9007199254740991,l=r("length");e.exports=u},{}],13:[function(t,e,n){function r(t,e){if("function"!=typeof t)throw new TypeError(i);return e=o(void 0===e?t.length-1:+e||0,0),function(){for(var n=arguments,r=-1,i=o(n.length-e,0),u=Array(i);++r<i;)u[r]=n[e+r];switch(e){case 0:return t.call(this,u);case 1:return t.call(this,n[0],u);case 2:return t.call(this,n[0],n[1],u)}var c=Array(e+1);for(r=-1;++r<e;)c[r]=n[r];return c[e]=u,t.apply(this,c)}}var i="Expected a function",o=Math.max;e.exports=r},{}],14:[function(t,e,n){function r(t){return function(e){return null==e?void 0:e[t]}}function i(t){return null!=t&&u(g(t))}function o(t,e){return t="number"==typeof t||d.test(t)?+t:-1,e=null==e?v:e,t>-1&&t%1==0&&e>t}function u(t){return"number"==typeof t&&t>-1&&t%1==0&&v>=t}function c(t){for(var e=a(t),n=e.length,r=n&&t.length,i=!!r&&u(r)&&(p(t)||l(t)),c=-1,s=[];++c<n;){var f=e[c];(i&&o(f,r)||y.call(t,f))&&s.push(f)}return s}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function a(t){if(null==t)return[];s(t)||(t=Object(t));var e=t.length;e=e&&u(e)&&(p(t)||l(t))&&e||0;for(var n=t.constructor,r=-1,i="function"==typeof n&&n.prototype===t,c=Array(e),a=e>0;++r<e;)c[r]=r+"";for(var f in t)a&&o(f,e)||"constructor"==f&&(i||!y.call(t,f))||c.push(f);return c}var f=t("lodash._getnative"),l=t("lodash.isarguments"),p=t("lodash.isarray"),d=/^\d+$/,h=Object.prototype,y=h.hasOwnProperty,m=f(Object,"keys"),v=9007199254740991,g=r("length"),b=m?function(t){var e=null==t?void 0:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&i(t)?c(t):s(t)?m(t):[]}:c;e.exports=b},{"lodash._getnative":15,"lodash.isarguments":16,"lodash.isarray":17}],15:[function(t,e,n){function r(t){return!!t&&"object"==typeof t}function i(t,e){var n=null==t?void 0:t[e];return c(n)?n:void 0}function o(t){return u(t)&&d.call(t)==s}function u(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function c(t){return null==t?!1:o(t)?h.test(l.call(t)):r(t)&&a.test(t)}var s="[object Function]",a=/^\[object .+?Constructor\]$/,f=Object.prototype,l=Function.prototype.toString,p=f.hasOwnProperty,d=f.toString,h=RegExp("^"+l.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=i},{}],16:[function(t,e,n){function r(t){return!!t&&"object"==typeof t}function i(t){return function(e){return null==e?void 0:e[t]}}function o(t){return null!=t&&u(p(t))}function u(t){return"number"==typeof t&&t>-1&&t%1==0&&l>=t}function c(t){return r(t)&&o(t)&&a.call(t,"callee")&&!f.call(t,"callee")}var s=Object.prototype,a=s.hasOwnProperty,f=s.propertyIsEnumerable,l=9007199254740991,p=i("length");e.exports=c},{}],17:[function(t,e,n){function r(t){return!!t&&"object"==typeof t}function i(t,e){var n=null==t?void 0:t[e];return s(n)?n:void 0}function o(t){return"number"==typeof t&&t>-1&&t%1==0&&g>=t}function u(t){return c(t)&&y.call(t)==f}function c(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function s(t){return null==t?!1:u(t)?m.test(d.call(t)):r(t)&&l.test(t)}var a="[object Array]",f="[object Function]",l=/^\[object .+?Constructor\]$/,p=Object.prototype,d=Function.prototype.toString,h=p.hasOwnProperty,y=p.toString,m=RegExp("^"+d.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),v=i(Array,"isArray"),g=9007199254740991,b=v||function(t){return r(t)&&o(t.length)&&y.call(t)==a};e.exports=b},{}],18:[function(t,e,n){function r(t,e,n){function r(){v&&clearTimeout(v),d&&clearTimeout(d),b=0,d=v=g=void 0}function o(e,n){n&&clearTimeout(n),d=v=g=void 0,e&&(b=a(),h=t.apply(m,p),v||d||(p=m=void 0))}function s(){var t=e-(a()-y);0>=t||t>e?o(g,d):v=setTimeout(s,t)}function f(){o(x,v)}function l(){if(p=arguments,y=a(),m=this,g=x&&(v||!_),w===!1)var n=_&&!v;else{d||_||(b=y);var r=w-(y-b),i=0>=r||r>w;i?(d&&(d=clearTimeout(d)),b=y,h=t.apply(m,p)):d||(d=setTimeout(f,r))}return i&&v?v=clearTimeout(v):v||e===w||(v=setTimeout(s,e)),n&&(i=!0,h=t.apply(m,p)),!i||v||d||(p=m=void 0),h}var p,d,h,y,m,v,g,b=0,w=!1,x=!0;if("function"!=typeof t)throw new TypeError(u);if(e=0>e?0:+e||0,n===!0){var _=!0;x=!1}else i(n)&&(_=!!n.leading,w="maxWait"in n&&c(+n.maxWait||0,e),x="trailing"in n?!!n.trailing:x);return l.cancel=r,l}function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var o=t("lodash._getnative"),u="Expected a function",c=Math.max,s=o(Date,"now"),a=s||function(){return(new Date).getTime()};e.exports=r},{"lodash._getnative":19}],19:[function(t,e,n){arguments[4][15][0].apply(n,arguments)},{dup:15}],20:[function(t,e,n){"use strict";e.exports=function(t){return window.atob(t)}},{}],21:[function(t,e,n){"use strict";var r=t("rest/interceptor"),i=r({success:function(t){var e=t&&t.request,n=e&&e.callback;return"function"==typeof n&&n(null,t.entity),t},error:function(t){var e=t&&t.request,n=e&&e.callback;if("function"==typeof n){var r=t.error||t.entity;"object"!=typeof r&&(r=new Error(r)),n(r)}return t}});e.exports=i},{"rest/interceptor":32}],22:[function(t,e,n){"use strict";var r=t("rest"),i=t("./callbackify");e.exports=function(e){return r.wrap(t("rest/interceptor/errorCode")).wrap(t("rest/interceptor/pathPrefix"),{prefix:e.endpoint}).wrap(t("rest/interceptor/mime"),{mime:"application/json"}).wrap(t("rest/interceptor/defaultRequest"),{params:{access_token:e.accessToken}}).wrap(t("rest/interceptor/template")).wrap(i)}},{"./callbackify":21,rest:28,"rest/interceptor/defaultRequest":33,"rest/interceptor/errorCode":34,"rest/interceptor/mime":35,"rest/interceptor/pathPrefix":36,"rest/interceptor/template":37}],23:[function(t,e,n){e.exports.DEFAULT_ENDPOINT="https://api.mapbox.com",e.exports.API_GEOCODER_FORWARD="/geocoding/v5/{dataset}/{query}.json{?proximity}",e.exports.API_GEOCODER_REVERSE="/geocoding/v5/{dataset}/{longitude},{latitude}.json",e.exports.API_DIRECTIONS="/v4/directions/{profile}/{encodedWaypoints}.json{?alternatives,instructions,geometry,steps}",e.exports.API_DISTANCE="/distances/v1/mapbox/{profile}",e.exports.API_SURFACE="/v4/surface/{mapid}.json{?layer,fields,points,geojson,interpolate,encoded_polyline}",e.exports.API_UPLOADS="/uploads/v1/{owner}",e.exports.API_UPLOAD="/uploads/v1/{owner}/{upload}",e.exports.API_UPLOAD_CREDENTIALS="/uploads/v1/{owner}/credentials",e.exports.API_MATCHING="/matching/v4/{profile}.json",e.exports.API_DATASET_DATASETS="/datasets/v1/{owner}",e.exports.API_DATASET_DATASET="/datasets/v1/{owner}/{dataset}",e.exports.API_DATASET_FEATURES="/datasets/v1/{owner}/{dataset}/features",e.exports.API_DATASET_FEATURE="/datasets/v1/{owner}/{dataset}/features/{id}",e.exports.API_TILESTATS_STATISTICS="/tilestats/v1/{owner}/{tileset}",e.exports.API_TILESTATS_LAYER="/tilestats/v1/{owner}/{tileset}/{layer}",e.exports.API_TILESTATS_ATTRIBUTE="/tilestats/v1/{owner}/{tileset}/{layer}/{attribute}",e.exports.API_STATIC="/v4/{mapid}{+overlay}/{+xyz}/{width}x{height}{+retina}{.format}"},{}],24:[function(t,e,n){(function(n){"use strict";function r(t){var e=t.split(".")[1];if(!e)return null;if(e=e.replace(/-/g,"+").replace(/_/g,"/"),n.browser)e=e.replace(/=/g,"");else{var r=e.length%4;if(2===r&&(e+="=="),3===r&&(e+="="),1===r||r>3)return null}try{return JSON.parse(i(e)).u}catch(o){return null}}var i=t("atob");e.exports=r}).call(this,t("_process"))},{_process:4,atob:20}],25:[function(t,e,n){"use strict";function r(t){function e(e,n){this.name=t,i("string"==typeof e,"accessToken required to instantiate Mapbox client");var r=o.DEFAULT_ENDPOINT;void 0!==n&&(i("object"==typeof n,"options must be an object"),n.endpoint&&(i("string"==typeof n.endpoint,"endpoint must be a string"),r=n.endpoint),n.account&&(i("string"==typeof n.account,"account must be a string"),this.owner=n.account)),this.client=u({endpoint:r,accessToken:e}),this.accessToken=e,this.endpoint=r,this.owner=this.owner||c(e),i(!!this.owner,"could not determine account from provided accessToken")}return e}var i=t("assert"),o=t("./constants"),u=t("./client"),c=t("./get_user");e.exports=r},{"./client":22,"./constants":23,"./get_user":24,assert:2}],26:[function(t,e,n){"use strict";function r(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var i=t("assert"),o=t("../make_service"),u=t("../constants"),c=o("MapboxGeocoder"),s=5,a=3;c.prototype.geocodeForward=function(t,e,n){void 0===n&&"function"==typeof e&&(n=e,e={}),i("string"==typeof t,"query must be a string"),i("object"==typeof e,"options must be an object"),i("function"==typeof n,"callback must be a function");var o={query:t,dataset:"mapbox.places"},c=a;e.precision&&(i("number"==typeof e.precision,"precision option must be number"),c=e.precision),e.proximity&&(i("number"==typeof e.proximity.latitude&&"number"==typeof e.proximity.longitude,"proximity must be an object with numeric latitude & longitude properties"),o.proximity=r(e.proximity.longitude,c)+","+r(e.proximity.latitude,c)),e.dataset&&(i("string"==typeof e.dataset,"dataset option must be string"),o.dataset=e.dataset),this.client({path:u.API_GEOCODER_FORWARD,params:o,callback:n})},c.prototype.geocodeReverse=function(t,e,n){void 0===n&&"function"==typeof e&&(n=e,e={}),i("object"==typeof t,"location must be an object"),i("object"==typeof e,"options must be an object"),i("function"==typeof n,"callback must be a function"),i("number"==typeof t.latitude&&"number"==typeof t.longitude,"location must be an object with numeric latitude & longitude properties");var o="mapbox.places";e.dataset&&(i("string"==typeof e.dataset,"dataset option must be string"),o=e.dataset);var c=s;e.precision&&(i("number"==typeof e.precision,"precision option must be number"),c=e.precision),this.client({path:u.API_GEOCODER_REVERSE,params:{longitude:r(t.longitude,c),latitude:r(t.latitude,c),dataset:o},callback:n})},e.exports=c},{"../constants":23,"../make_service":25,assert:2}],27:[function(t,e,n){!function(t,e){"use strict";var n;t(function(t){function r(t,e){var n,r,i,o;if(n=t,i={},e){for(r in e)o=new RegExp("\\{"+r+"\\}"),o.test(n)?n=n.replace(o,encodeURIComponent(e[r]),"g"):i[r]=e[r];for(r in i)n+=-1===n.indexOf("?")?"?":"&",n+=encodeURIComponent(r),null!==i[r]&&void 0!==i[r]&&(n+="=",n+=encodeURIComponent(i[r]))}return n}function i(t,e){return 0===t.indexOf(e)}function o(t,e){return this instanceof o?void(t instanceof o?(this._template=t.template,this._params=u({},this._params,e)):(this._template=(t||"").toString(),this._params=e||{})):new o(t,e)}var u,c,s,a,f;return u=t("./util/mixin"),s=/([a-z][a-z0-9\+\-\.]*:)\/\/([^@]+@)?(([^:\/]+)(:([0-9]+))?)?(\/[^?#]*)?(\?[^#]*)?(#\S*)?/i,a=/^([a-z][a-z0-9\-\+\.]*:\/\/|\/)/i,f=/([a-z][a-z0-9\+\-\.]*:)\/\/([^@]+@)?(([^:\/]+)(:([0-9]+))?)?\//i,o.prototype={append:function(t,e){return new o(this._template+t,u({},this._params,e))},fullyQualify:function(){if(!e)return this;if(this.isFullyQualified())return this;var t=this._template;return i(t,"//")?t=c.protocol+t:i(t,"/")?t=c.origin+t:this.isAbsolute()||(t=c.origin+c.pathname.substring(0,c.pathname.lastIndexOf("/")+1)),-1===t.indexOf("/",8)&&(t+="/"),new o(t,this._params)},isAbsolute:function(){return a.test(this.build())},isFullyQualified:function(){return f.test(this.build())},isCrossOrigin:function(){if(!c)return!0;var t=this.parts();return t.protocol!==c.protocol||t.hostname!==c.hostname||t.port!==c.port},parts:function(){var t,e;return t=this.fullyQualify().build().match(s),e={href:t[0],protocol:t[1],host:t[3]||"",hostname:t[4]||"",port:t[6],pathname:t[7]||"",search:t[8]||"",hash:t[9]||""},e.origin=e.protocol+"//"+e.host,e.port=e.port||("https:"===e.protocol?"443":"http:"===e.protocol?"80":""),e},build:function(t){return r(this._template,u({},this._params,t))},toString:function(){return this.build()}},c=e?new o(e.href).parts():n,o})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)},"undefined"!=typeof window?window.location:void 0)},{"./util/mixin":65}],28:[function(t,e,n){!function(t){"use strict";t(function(t){var e=t("./client/default"),n=t("./client/xhr");return e.setPlatformDefaultClient(n),e})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"./client/default":30,"./client/xhr":31}],29:[function(t,e,n){!function(t){"use strict";t(function(){return function(t,e){return e&&(t.skip=function(){return e}),t.wrap=function(e,n){return e(t,n)},t.chain=function(){return"undefined"!=typeof console&&console.log("rest.js: client.chain() is deprecated, use client.wrap() instead"),t.wrap.apply(this,arguments)},t}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{}],30:[function(t,e,n){!function(t){"use strict";var e;t(function(t){function n(){return i.apply(e,arguments)}var r,i,o;return r=t("../client"),n.setDefaultClient=function(t){i=t},n.getDefaultClient=function(){return i},n.resetDefaultClient=function(){i=o},n.setPlatformDefaultClient=function(t){if(o)throw new Error("Unable to redefine platformDefaultClient");i=o=t},r(n)})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"../client":29}],31:[function(t,e,n){!function(t,e){"use strict";t(function(t){function n(t){var e={};return t?(t.trim().split(a).forEach(function(t){var n,r,i;n=t.indexOf(":"),r=u(t.substring(0,n).trim()),i=t.substring(n+1).trim(),e[r]?Array.isArray(e[r])?e[r].push(i):e[r]=[e[r],i]:e[r]=i}),e):e}function r(t,e){return Object.keys(e||{}).forEach(function(n){if(e.hasOwnProperty(n)&&n in t)try{t[n]=e[n]}catch(r){}}),t}var i,o,u,c,s,a;return i=t("when"),o=t("../UrlBuilder"),u=t("../util/normalizeHeaderName"),c=t("../util/responsePromise"),s=t("../client"),a=/[\r|\n]+/,s(function(t){return c.promise(function(i,u){var c,s,a,f,l,p,d,h;if(t="string"==typeof t?{path:t}:t||{},d={request:t},t.canceled)return d.error="precanceled",void u(d);if(h=t.engine||e.XMLHttpRequest,!h)return void u({request:t,error:"xhr-not-available"});l=t.entity,t.method=t.method||(l?"POST":"GET"),s=t.method,a=new o(t.path||"",t.params).build();try{c=d.raw=new h,r(c,t.mixin),c.open(s,a,!0),r(c,t.mixin),f=t.headers;for(p in f)("Content-Type"!==p||"multipart/form-data"!==f[p])&&c.setRequestHeader(p,f[p]);t.canceled=!1,t.cancel=function(){t.canceled=!0,c.abort(),u(d)},c.onreadystatechange=function(){t.canceled||c.readyState===(h.DONE||4)&&(d.status={code:c.status,text:c.statusText},d.headers=n(c.getAllResponseHeaders()),d.entity=c.responseText,d.status.code>0?i(d):setTimeout(function(){i(d)},0))};try{c.onerror=function(){d.error="loaderror",u(d)}}catch(y){}c.send(l)}catch(y){d.error="loaderror",u(d)}})})})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)},"undefined"!=typeof window?window:void 0)},{"../UrlBuilder":27,"../client":29,"../util/normalizeHeaderName":66,"../util/responsePromise":67,when:62}],32:[function(t,e,n){!function(t){"use strict";t(function(t){function e(t){return t}function n(t){return t}function r(t){return t}function i(t){return l.promise(function(e,n){t.forEach(function(t){l(t,e,n)})})}function o(t){return this instanceof o?void s(this,t):new o(t)}function u(t){var u,s,p,d;return t=t||{},u=t.init||e,s=t.request||n,p=t.success||t.response||r,d=t.error||function(){return l((t.response||r).apply(this,arguments),l.reject,l.reject)},function(e,n){function r(t){var u,c;return u={},c={arguments:Array.prototype.slice.call(arguments),client:r},t="string"==typeof t?{path:t}:t||{},t.originator=t.originator||r,a(s.call(u,t,n,c),function(t){var r,s,a;return a=e,t instanceof o&&(s=t.abort,a=t.client||a,r=t.response,t=t.request),r=r||l(t,function(t){return l(a(t),function(t){return p.call(u,t,n,c)},function(t){return d.call(u,t,n,c)})}),s?i([r,s]):r},function(e){return l.reject({request:t,error:e})})}return"object"==typeof e&&(n=e),"function"!=typeof e&&(e=t.client||c),n=u(n||{}),f(r,e)}}var c,s,a,f,l;return c=t("./client/default"),s=t("./util/mixin"),a=t("./util/responsePromise"),f=t("./client"),l=t("when"),u.ComplexRequest=o,u})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"./client":29,"./client/default":30,"./util/mixin":65,"./util/responsePromise":67,when:62}],33:[function(t,e,n){!function(t){"use strict";t(function(t){var e,n,r;return e=t("../interceptor"),n=t("../util/mixin"),r=function(){function t(t,e,r){(t in e||t in r)&&(e[t]=n({},r[t],e[t]))}function e(t,e,n){t in n&&!(t in e)&&(e[t]=n[t])}var r={method:e,path:e,params:t,headers:t,entity:e,mixin:t};return function(t,e){for(var n in r)r[n](n,t,e);return t}}(),e({request:function(t,e){return r(t,e)}})})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"../interceptor":32,"../util/mixin":65}],34:[function(t,e,n){!function(t){"use strict";t(function(t){var e,n;return e=t("../interceptor"),n=t("when"),e({init:function(t){return t.code=t.code||400,t},response:function(t,e){return t.status&&t.status.code>=e.code?n.reject(t):t}})})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"../interceptor":32,when:62}],35:[function(t,e,n){!function(t){"use strict";t(function(t){var e,n,r,i,o;return e=t("../interceptor"),n=t("../mime"),r=t("../mime/registry"),o=t("when"),i={read:function(t){return t},write:function(t){return t}},e({init:function(t){return t.registry=t.registry||r,t},request:function(t,e){var r,u;return u=t.headers||(t.headers={}),r=n.parse(u["Content-Type"]=u["Content-Type"]||e.mime||"text/plain"),u.Accept=u.Accept||e.accept||r.raw+", application/json;q=0.8, text/plain;q=0.5, */*;q=0.2","entity"in t?e.registry.lookup(r).otherwise(function(){if(e.permissive)return i;throw"mime-unknown"}).then(function(n){var i=e.client||t.originator;return o.attempt(n.write,t.entity,{client:i,request:t,mime:r,registry:e.registry}).otherwise(function(){throw"mime-serialization"}).then(function(e){return t.entity=e,t})}):t},response:function(t,e){if(!(t.headers&&t.headers["Content-Type"]&&t.entity))return t;var r=n.parse(t.headers["Content-Type"]);return e.registry.lookup(r).otherwise(function(){return i}).then(function(n){var i=e.client||t.request&&t.request.originator;return o.attempt(n.read,t.entity,{client:i,response:t,mime:r,registry:e.registry}).otherwise(function(e){throw t.error="mime-deserialization",t.cause=e,t}).then(function(e){return t.entity=e,t})})}})})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"../interceptor":32,"../mime":38,"../mime/registry":39,when:62}],36:[function(t,e,n){!function(t){"use strict";t(function(t){function e(t,e){return 0===t.indexOf(e)}function n(t,e){return t.lastIndexOf(e)+e.length===t.length;
}var r,i;return r=t("../interceptor"),i=t("../UrlBuilder"),r({request:function(t,r){var o;return r.prefix&&!new i(t.path).isFullyQualified()&&(o=r.prefix,t.path&&(n(o,"/")||e(t.path,"/")||(o+="/"),o+=t.path),t.path=o),t}})})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"../UrlBuilder":27,"../interceptor":32}],37:[function(t,e,n){!function(t){"use strict";t(function(t){var e,n,r;return e=t("../interceptor"),n=t("../util/uriTemplate"),r=t("../util/mixin"),e({init:function(t){return t.params=t.params||{},t.template=t.template||"",t},request:function(t,e){var i,o;return i=t.path||e.template,o=r({},t.params,e.params),t.path=n.expand(i,o),delete t.params,t}})})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"../interceptor":32,"../util/mixin":65,"../util/uriTemplate":69}],38:[function(t,e,n){!function(t){"use strict";var e;t(function(){function t(t){var n,r;return n=t.split(";"),r=n[0].trim().split("+"),{raw:t,type:r[0],suffix:r[1]?"+"+r[1]:"",params:n.slice(1).reduce(function(t,n){return n=n.split("="),t[n[0].trim()]=n[1]?n[1].trim():e,t},{})}}return{parse:t}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{}],39:[function(t,e,n){!function(t){"use strict";t(function(t){function e(t){this.lookup=function(e){var i;return i="string"==typeof e?n.parse(e):e,t[i.raw]?t[i.raw]:t[i.type+i.suffix]?t[i.type+i.suffix]:t[i.type]?t[i.type]:t[i.suffix]?t[i.suffix]:r.reject(new Error('Unable to locate converter for mime "'+i.raw+'"'))},this.delegate=function(t){return{read:function(){var e=arguments;return this.lookup(t).then(function(t){return t.read.apply(this,e)}.bind(this))}.bind(this),write:function(){var e=arguments;return this.lookup(t).then(function(t){return t.write.apply(this,e)}.bind(this))}.bind(this)}},this.register=function(e,n){return t[e]=r(n),t[e]},this.child=function(){return new e(Object.create(t))}}var n,r,i;return n=t("../mime"),r=t("when"),i=new e({}),i.register("application/hal",t("./type/application/hal")),i.register("application/json",t("./type/application/json")),i.register("application/x-www-form-urlencoded",t("./type/application/x-www-form-urlencoded")),i.register("multipart/form-data",t("./type/multipart/form-data")),i.register("text/plain",t("./type/text/plain")),i.register("+json",i.delegate("application/json")),i})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"../mime":38,"./type/application/hal":40,"./type/application/json":41,"./type/application/x-www-form-urlencoded":42,"./type/multipart/form-data":43,"./type/text/plain":44,when:62}],40:[function(t,e,n){!function(t){"use strict";t(function(t){function e(t,e,n){Object.defineProperty(t,e,{value:n,configurable:!0,enumerable:!1,writeable:!0})}var n,r,i,o,u,c;return n=t("../../../interceptor/pathPrefix"),r=t("../../../interceptor/template"),i=t("../../../util/find"),o=t("../../../util/lazyPromise"),u=t("../../../util/responsePromise"),c=t("when"),{read:function(t,s){function a(t,e){(e&&l&&l.warn||l.log)&&(l.warn||l.log).call(l,"Relationship '"+t+"' is deprecated, see "+e)}var f,l;return s=s||{},f=s.client,l=s.console||l,s.registry.lookup(s.mime.suffix).then(function(l){return c(l.read(t,s)).then(function(t){return i.findProperties(t,"_embedded",function(t,n,r){Object.keys(t).forEach(function(r){if(!(r in n)){var i=u({entity:t[r]});e(n,r,i)}}),e(n,r,t)}),i.findProperties(t,"_links",function(t,i,c){Object.keys(t).forEach(function(n){var c=t[n];n in i||e(i,n,u.make(o(function(){return c.deprecation&&a(n,c.deprecation),c.templated===!0?r(f)({path:c.href}):f({path:c.href})})))}),e(i,c,t),e(i,"clientFor",function(e,i){var o=t[e];if(!o)throw new Error("Unknown relationship: "+e);return o.deprecation&&a(e,o.deprecation),o.templated===!0?r(i||f,{template:o.href}):n(i||f,{prefix:o.href})}),e(i,"requestFor",function(t,e,n){var r=this.clientFor(t,n);return r(e)})}),t})})},write:function(t,e){return e.registry.lookup(e.mime.suffix).then(function(n){return n.write(t,e)})}}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"../../../interceptor/pathPrefix":36,"../../../interceptor/template":37,"../../../util/find":63,"../../../util/lazyPromise":64,"../../../util/responsePromise":67,when:62}],41:[function(t,e,n){!function(t){"use strict";t(function(){function t(e,n){return{read:function(t){return JSON.parse(t,e)},write:function(t){return JSON.stringify(t,n)},extend:t}}return t()})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{}],42:[function(t,e,n){!function(t){"use strict";t(function(){function t(t){return t=encodeURIComponent(t),t.replace(r,"+")}function e(t){return t=t.replace(i," "),decodeURIComponent(t)}function n(e,r,i){return Array.isArray(i)?i.forEach(function(t){e=n(e,r,t)}):(e.length>0&&(e+="&"),e+=t(r),void 0!==i&&null!==i&&(e+="="+t(i))),e}var r,i;return r=/%20/g,i=/\+/g,{read:function(t){var n={};return t.split("&").forEach(function(t){var r,i,o;r=t.split("="),i=e(r[0]),o=2===r.length?e(r[1]):null,i in n?(Array.isArray(n[i])||(n[i]=[n[i]]),n[i].push(o)):n[i]=o}),n},write:function(t){var e="";return Object.keys(t).forEach(function(r){e=n(e,r,t[r])}),e}}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{}],43:[function(t,e,n){!function(t){"use strict";t(function(){function t(t){return t&&1===t.nodeType&&"FORM"===t.tagName}function e(t){var e,n=new FormData;for(var r in t)t.hasOwnProperty(r)&&(e=t[r],e instanceof File?n.append(r,e,e.name):e instanceof Blob?n.append(r,e):n.append(r,String(e)));return n}return{write:function(n){if("undefined"==typeof FormData)throw new Error("The multipart/form-data mime serializer requires FormData support");if(n instanceof FormData)return n;if(t(n))return new FormData(n);if("object"==typeof n&&null!==n)return e(n);throw new Error("Unable to create FormData from object "+n)}}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{}],44:[function(t,e,n){!function(t){"use strict";t(function(){return{read:function(t){return t},write:function(t){return t.toString()}}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{}],45:[function(t,e,n){!function(t){"use strict";t(function(t){var e=t("./makePromise"),n=t("./Scheduler"),r=t("./env").asap;return e({scheduler:new n(r)})})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"./Scheduler":46,"./env":58,"./makePromise":60}],46:[function(t,e,n){!function(t){"use strict";t(function(){function t(t){this._async=t,this._running=!1,this._queue=this,this._queueLen=0,this._afterQueue={},this._afterQueueLen=0;var e=this;this.drain=function(){e._drain()}}return t.prototype.enqueue=function(t){this._queue[this._queueLen++]=t,this.run()},t.prototype.afterQueue=function(t){this._afterQueue[this._afterQueueLen++]=t,this.run()},t.prototype.run=function(){this._running||(this._running=!0,this._async(this.drain))},t.prototype._drain=function(){for(var t=0;t<this._queueLen;++t)this._queue[t].run(),this._queue[t]=void 0;for(this._queueLen=0,this._running=!1,t=0;t<this._afterQueueLen;++t)this._afterQueue[t].run(),this._afterQueue[t]=void 0;this._afterQueueLen=0},t})}("function"==typeof define&&define.amd?define:function(t){e.exports=t()})},{}],47:[function(t,e,n){!function(t){"use strict";t(function(){function t(e){Error.call(this),this.message=e,this.name=t.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t})}("function"==typeof define&&define.amd?define:function(t){e.exports=t()})},{}],48:[function(t,e,n){!function(t){"use strict";t(function(){function t(t,n){function r(e,r,o){var u=t._defer(),c=o.length,s=new Array(c);return i({f:e,thisArg:r,args:o,params:s,i:c-1,call:n},u._handler),u}function i(e,r){if(e.i<0)return n(e.f,e.thisArg,e.params,r);var i=t._handler(e.args[e.i]);i.fold(o,e,void 0,r)}function o(t,e,n){t.params[t.i]=e,t.i-=1,i(t,n)}return arguments.length<2&&(n=e),r}function e(t,e,n,r){try{r.resolve(t.apply(e,n))}catch(i){r.reject(i)}}return t.tryCatchResolve=e,t})}("function"==typeof define&&define.amd?define:function(t){e.exports=t()})},{}],49:[function(t,e,n){!function(t){"use strict";t(function(t){var e=t("../state"),n=t("../apply");return function(t){function r(e){function n(t){f=null,this.resolve(t)}function r(t){this.resolved||(f.push(t),0===--a&&this.reject(f))}for(var i,o,u=t._defer(),c=u._handler,s=e.length>>>0,a=s,f=[],l=0;s>l;++l)if(o=e[l],void 0!==o||l in e){if(i=t._handler(o),i.state()>0){c.become(i),t._visitRemaining(e,l,i);break}i.visit(c,n,r)}else--a;return 0===a&&c.reject(new RangeError("any(): array must not be empty")),u}function i(e,n){function r(t){this.resolved||(f.push(t),0===--d&&(l=null,this.resolve(f)))}function i(t){this.resolved||(l.push(t),0===--o&&(f=null,this.reject(l)))}var o,u,c,s=t._defer(),a=s._handler,f=[],l=[],p=e.length>>>0,d=0;for(c=0;p>c;++c)u=e[c],(void 0!==u||c in e)&&++d;for(n=Math.max(n,0),o=d-n+1,d=Math.min(n,d),n>d?a.reject(new RangeError("some(): array must contain at least "+n+" item(s), but had "+d)):0===d&&a.resolve(f),c=0;p>c;++c)u=e[c],(void 0!==u||c in e)&&t._handler(u).visit(a,r,i,a.notify);return s}function o(e,n){return t._traverse(n,e)}function u(e,n){var r=g.call(e);return t._traverse(n,r).then(function(t){return c(r,t)})}function c(e,n){for(var r=n.length,i=new Array(r),o=0,u=0;r>o;++o)n[o]&&(i[u++]=t._handler(e[o]).value);return i.length=u,i}function s(t){return y(t.map(a))}function a(n){var r=t._handler(n);return 0===r.state()?h(n).then(e.fulfilled,e.rejected):(r._unreport(),e.inspect(r))}function f(t,e){return arguments.length>2?m.call(t,p(e),arguments[2]):m.call(t,p(e))}function l(t,e){return arguments.length>2?v.call(t,p(e),arguments[2]):v.call(t,p(e))}function p(t){return function(e,n,r){return d(t,void 0,[e,n,r])}}var d=n(t),h=t.resolve,y=t.all,m=Array.prototype.reduce,v=Array.prototype.reduceRight,g=Array.prototype.slice;return t.any=r,t.some=i,t.settle=s,t.map=o,t.filter=u,t.reduce=f,t.reduceRight=l,t.prototype.spread=function(t){return this.then(y).then(function(e){return t.apply(this,e)})},t}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"../apply":48,"../state":61}],50:[function(t,e,n){!function(t){"use strict";t(function(){function t(){throw new TypeError("catch predicate must be a function")}function e(t,e){return n(e)?t instanceof e:e(t)}function n(t){return t===Error||null!=t&&t.prototype instanceof Error}function r(t){return("object"==typeof t||"function"==typeof t)&&null!==t}function i(t){return t}return function(n){function o(t,n){return function(r){return e(r,n)?t.call(this,r):a(r)}}function u(t,e,n,i){var o=t.call(e);return r(o)?c(o,n,i):n(i)}function c(t,e,n){return s(t).then(function(){return e(n)})}var s=n.resolve,a=n.reject,f=n.prototype["catch"];return n.prototype.done=function(t,e){this._handler.visit(this._handler.receiver,t,e)},n.prototype["catch"]=n.prototype.otherwise=function(e){return arguments.length<2?f.call(this,e):"function"!=typeof e?this.ensure(t):f.call(this,o(arguments[1],e))},n.prototype["finally"]=n.prototype.ensure=function(t){return"function"!=typeof t?this:this.then(function(e){return u(t,this,i,e)},function(e){return u(t,this,a,e)})},n.prototype["else"]=n.prototype.orElse=function(t){return this.then(void 0,function(){return t})},n.prototype["yield"]=function(t){return this.then(function(){return t})},n.prototype.tap=function(t){return this.then(t)["yield"](this)},n}})}("function"==typeof define&&define.amd?define:function(t){e.exports=t()})},{}],51:[function(t,e,n){!function(t){"use strict";t(function(){return function(t){return t.prototype.fold=function(e,n){var r=this._beget();return this._handler.fold(function(n,r,i){t._handler(n).fold(function(t,n,r){r.resolve(e.call(this,n,t))},r,this,i)},n,r._handler.receiver,r._handler),r},t}})}("function"==typeof define&&define.amd?define:function(t){e.exports=t()})},{}],52:[function(t,e,n){!function(t){"use strict";t(function(t){var e=t("../state").inspect;return function(t){return t.prototype.inspect=function(){return e(t._handler(this))},t}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"../state":61}],53:[function(t,e,n){!function(t){"use strict";t(function(){return function(t){function e(t,e,r,i){return n(function(e){return[e,t(e)]},e,r,i)}function n(t,e,i,o){function u(o,u){return r(i(o)).then(function(){return n(t,e,i,u)})}return r(o).then(function(n){return r(e(n)).then(function(e){return e?n:r(t(n)).spread(u)})})}var r=t.resolve;return t.iterate=e,t.unfold=n,t}})}("function"==typeof define&&define.amd?define:function(t){e.exports=t()})},{}],54:[function(t,e,n){!function(t){"use strict";t(function(){return function(t){return t.prototype.progress=function(t){return this.then(void 0,void 0,t)},t}})}("function"==typeof define&&define.amd?define:function(t){e.exports=t()})},{}],55:[function(t,e,n){!function(t){"use strict";t(function(t){function e(t,e,r,i){return n.setTimer(function(){t(r,i,e)},e)}var n=t("../env"),r=t("../TimeoutError");return function(t){function i(t,n,r){e(o,t,n,r)}function o(t,e){e.resolve(t)}function u(t,e,n){var i="undefined"==typeof t?new r("timed out after "+n+"ms"):t;e.reject(i)}return t.prototype.delay=function(t){var e=this._beget();return this._handler.fold(i,t,void 0,e._handler),e},t.prototype.timeout=function(t,r){var i=this._beget(),o=i._handler,c=e(u,t,r,i._handler);return this._handler.visit(o,function(t){n.clearTimer(c),this.resolve(t)},function(t){n.clearTimer(c),this.reject(t)},o.notify),i},t}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"../TimeoutError":47,"../env":58}],56:[function(t,e,n){!function(t){"use strict";t(function(t){function e(t){throw t}function n(){}var r=t("../env").setTimer,i=t("../format");return function(t){function o(t){t.handled||(d.push(t),f("Potentially unhandled rejection ["+t.id+"] "+i.formatError(t.value)))}function u(t){var e=d.indexOf(t);e>=0&&(d.splice(e,1),l("Handled previous rejection ["+t.id+"] "+i.formatObject(t.value)))}function c(t,e){p.push(t,e),null===h&&(h=r(s,0))}function s(){for(h=null;p.length>0;)p.shift()(p.shift())}var a,f=n,l=n;"undefined"!=typeof console&&(a=console,f="undefined"!=typeof a.error?function(t){a.error(t)}:function(t){a.log(t)},l="undefined"!=typeof a.info?function(t){a.info(t)}:function(t){a.log(t)}),t.onPotentiallyUnhandledRejection=function(t){c(o,t)},t.onPotentiallyUnhandledRejectionHandled=function(t){c(u,t)},t.onFatalRejection=function(t){c(e,t.value)};var p=[],d=[],h=null;return t}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"../env":58,"../format":59}],57:[function(t,e,n){!function(t){"use strict";t(function(){return function(t){return t.prototype["with"]=t.prototype.withThis=function(t){var e=this._beget(),n=e._handler;return n.receiver=t,this._handler.chain(n,t),e},t}})}("function"==typeof define&&define.amd?define:function(t){e.exports=t()})},{}],58:[function(t,e,n){(function(n){!function(t){"use strict";t(function(t){function e(){return"undefined"!=typeof n&&"[object process]"===Object.prototype.toString.call(n)}function r(){return"function"==typeof MutationObserver&&MutationObserver||"function"==typeof WebKitMutationObserver&&WebKitMutationObserver}function i(t){function e(){var t=n;n=void 0,t()}var n,r=document.createTextNode(""),i=new t(e);i.observe(r,{characterData:!0});var o=0;return function(t){n=t,r.data=o^=1}}var o,u="undefined"!=typeof setTimeout&&setTimeout,c=function(t,e){return setTimeout(t,e)},s=function(t){return clearTimeout(t)},a=function(t){return u(t,0)};if(e())a=function(t){return n.nextTick(t)};else if(o=r())a=i(o);else if(!u){var f=t,l=f("vertx");c=function(t,e){return l.setTimer(e,t)},s=l.cancelTimer,a=l.runOnLoop||l.runOnContext}return{setTimer:c,clearTimer:s,asap:a}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})}).call(this,t("_process"))},{_process:4}],59:[function(t,e,n){!function(t){"use strict";t(function(){function t(t){var n="object"==typeof t&&null!==t&&(t.stack||t.message)?t.stack||t.message:e(t);return t instanceof Error?n:n+" (WARNING: non-Error used)"}function e(t){var e=String(t);return"[object Object]"===e&&"undefined"!=typeof JSON&&(e=n(t,e)),e}function n(t,e){try{return JSON.stringify(t)}catch(n){return e}}return{formatError:t,formatObject:e,tryStringify:n}})}("function"==typeof define&&define.amd?define:function(t){e.exports=t()})},{}],60:[function(t,e,n){(function(t){!function(e){"use strict";e(function(){return function(e){function n(t,e){this._handler=t===w?e:r(t)}function r(t){function e(t){i.resolve(t)}function n(t){i.reject(t)}function r(t){i.notify(t)}var i=new _;try{t(e,n,r)}catch(o){n(o)}return i}function i(t){return I(t)?t:new n(w,new j(v(t)))}function o(t){return new n(w,new j(new T(t)))}function u(){return tt}function c(){return new n(w,new _)}function s(t,e){var n=new _(t.receiver,t.join().context);return new e(w,n)}function a(t){return l(Q,null,t)}function f(t,e){return l(N,t,e)}function l(t,e,r){function i(n,i,u){u.resolved||p(r,o,n,t(e,i,n),u)}function o(t,e,n){f[t]=e,0===--a&&n.become(new O(f))}for(var u,c="function"==typeof e?i:o,s=new _,a=r.length>>>0,f=new Array(a),l=0;l<r.length&&!s.resolved;++l)u=r[l],void 0!==u||l in r?p(r,c,l,u,s):--a;return 0===a&&s.become(new O(f)),new n(w,s)}function p(t,e,n,r,i){if(L(r)){var o=g(r),u=o.state();0===u?o.fold(e,n,void 0,i):u>0?e(n,o.value,i):(i.become(o),d(t,n+1,o))}else e(n,r,i)}function d(t,e,n){for(var r=e;r<t.length;++r)h(v(t[r]),n)}function h(t,e){if(t!==e){var n=t.state();0===n?t.visit(t,void 0,t._unreport):0>n&&t._unreport()}}function y(t){return"object"!=typeof t||null===t?o(new TypeError("non-iterable passed to race()")):0===t.length?u():1===t.length?i(t[0]):m(t)}function m(t){var e,r,i,o=new _;for(e=0;e<t.length;++e)if(r=t[e],void 0!==r||e in t){if(i=v(r),0!==i.state()){o.become(i),d(t,e+1,i);break}i.visit(o,o.resolve,o.reject)}return new n(w,o)}function v(t){return I(t)?t._handler.join():L(t)?b(t):new O(t)}function g(t){return I(t)?t._handler.join():b(t)}function b(t){try{var e=t.then;return"function"==typeof e?new E(e,t):new O(t)}catch(n){return new T(n)}}function w(){}function x(){}function _(t,e){n.createContext(this,e),this.consumers=void 0,this.receiver=t,this.handler=void 0,this.resolved=!1}function j(t){this.handler=t}function E(t,e){_.call(this),W.enqueue(new R(t,e,this))}function O(t){n.createContext(this),this.value=t}function T(t){n.createContext(this),this.id=++X,this.value=t,this.handled=!1,this.reported=!1,this._report()}function A(t,e){this.rejection=t,this.context=e}function S(t){this.rejection=t}function k(){return new T(new TypeError("Promise cycle"))}function C(t,e){this.continuation=t,this.handler=e}function P(t,e){this.handler=e,this.value=t}function R(t,e,n){this._then=t,this.thenable=e,this.resolver=n}function q(t,e,n,r,i){try{t.call(e,n,r,i)}catch(o){r(o)}}function D(t,e,n,r){this.f=t,this.z=e,this.c=n,this.to=r,this.resolver=Z,this.receiver=this}function I(t){return t instanceof n}function L(t){return("object"==typeof t||"function"==typeof t)&&null!==t}function U(t,e,r,i){return"function"!=typeof t?i.become(e):(n.enterContext(e),M(t,e.value,r,i),void n.exitContext())}function z(t,e,r,i,o){return"function"!=typeof t?o.become(r):(n.enterContext(r),H(t,e,r.value,i,o),void n.exitContext())}function F(t,e,r,i,o){return"function"!=typeof t?o.notify(e):(n.enterContext(r),$(t,e,i,o),void n.exitContext())}function N(t,e,n){try{return t(e,n)}catch(r){return o(r)}}function M(t,e,n,r){try{r.become(v(t.call(n,e)))}catch(i){r.become(new T(i))}}function H(t,e,n,r,i){try{t.call(r,e,n,i)}catch(o){i.become(new T(o))}}function $(t,e,n,r){try{r.notify(t.call(n,e))}catch(i){r.notify(i)}}function B(t,e){e.prototype=V(t.prototype),e.prototype.constructor=e}function Q(t,e){return e}function G(){}function J(){return"undefined"!=typeof t&&null!==t&&"function"==typeof t.emit?function(e,n){return"unhandledRejection"===e?t.emit(e,n.value,n):t.emit(e,n)}:"undefined"!=typeof self&&"function"==typeof CustomEvent?function(t,e,n){var r=!1;try{var i=new n("unhandledRejection");r=i instanceof n}catch(o){}return r?function(t,r){var i=new n(t,{detail:{reason:r.value,key:r},bubbles:!1,cancelable:!0});return!e.dispatchEvent(i)}:t}(G,self,CustomEvent):G}var W=e.scheduler,K=J(),V=Object.create||function(t){function e(){}return e.prototype=t,new e};n.resolve=i,n.reject=o,n.never=u,n._defer=c,n._handler=v,n.prototype.then=function(t,e,n){var r=this._handler,i=r.join().state();if("function"!=typeof t&&i>0||"function"!=typeof e&&0>i)return new this.constructor(w,r);var o=this._beget(),u=o._handler;return r.chain(u,r.receiver,t,e,n),o},n.prototype["catch"]=function(t){return this.then(void 0,t)},n.prototype._beget=function(){return s(this._handler,this.constructor)},n.all=a,n.race=y,n._traverse=f,n._visitRemaining=d,w.prototype.when=w.prototype.become=w.prototype.notify=w.prototype.fail=w.prototype._unreport=w.prototype._report=G,w.prototype._state=0,w.prototype.state=function(){return this._state},w.prototype.join=function(){for(var t=this;void 0!==t.handler;)t=t.handler;return t},w.prototype.chain=function(t,e,n,r,i){this.when({resolver:t,receiver:e,fulfilled:n,rejected:r,progress:i})},w.prototype.visit=function(t,e,n,r){this.chain(Z,t,e,n,r)},w.prototype.fold=function(t,e,n,r){this.when(new D(t,e,n,r))},B(w,x),x.prototype.become=function(t){t.fail()};var Z=new x;B(w,_),_.prototype._state=0,_.prototype.resolve=function(t){this.become(v(t))},_.prototype.reject=function(t){this.resolved||this.become(new T(t))},_.prototype.join=function(){if(!this.resolved)return this;for(var t=this;void 0!==t.handler;)if(t=t.handler,t===this)return this.handler=k();return t},_.prototype.run=function(){var t=this.consumers,e=this.handler;this.handler=this.handler.join(),this.consumers=void 0;for(var n=0;n<t.length;++n)e.when(t[n])},_.prototype.become=function(t){this.resolved||(this.resolved=!0,this.handler=t,void 0!==this.consumers&&W.enqueue(this),void 0!==this.context&&t._report(this.context))},_.prototype.when=function(t){this.resolved?W.enqueue(new C(t,this.handler)):void 0===this.consumers?this.consumers=[t]:this.consumers.push(t)},_.prototype.notify=function(t){this.resolved||W.enqueue(new P(t,this))},_.prototype.fail=function(t){var e="undefined"==typeof t?this.context:t;this.resolved&&this.handler.join().fail(e)},_.prototype._report=function(t){this.resolved&&this.handler.join()._report(t)},_.prototype._unreport=function(){this.resolved&&this.handler.join()._unreport()},B(w,j),j.prototype.when=function(t){W.enqueue(new C(t,this))},j.prototype._report=function(t){this.join()._report(t)},j.prototype._unreport=function(){this.join()._unreport()},B(_,E),B(w,O),O.prototype._state=1,O.prototype.fold=function(t,e,n,r){z(t,e,this,n,r)},O.prototype.when=function(t){U(t.fulfilled,this,t.receiver,t.resolver)};var X=0;B(w,T),T.prototype._state=-1,T.prototype.fold=function(t,e,n,r){r.become(this)},T.prototype.when=function(t){"function"==typeof t.rejected&&this._unreport(),U(t.rejected,this,t.receiver,t.resolver)},T.prototype._report=function(t){W.afterQueue(new A(this,t))},T.prototype._unreport=function(){this.handled||(this.handled=!0,W.afterQueue(new S(this)))},T.prototype.fail=function(t){this.reported=!0,K("unhandledRejection",this),n.onFatalRejection(this,void 0===t?this.context:t)},A.prototype.run=function(){this.rejection.handled||this.rejection.reported||(this.rejection.reported=!0,K("unhandledRejection",this.rejection)||n.onPotentiallyUnhandledRejection(this.rejection,this.context))},S.prototype.run=function(){this.rejection.reported&&(K("rejectionHandled",this.rejection)||n.onPotentiallyUnhandledRejectionHandled(this.rejection))},n.createContext=n.enterContext=n.exitContext=n.onPotentiallyUnhandledRejection=n.onPotentiallyUnhandledRejectionHandled=n.onFatalRejection=G;var Y=new w,tt=new n(w,Y);return C.prototype.run=function(){this.handler.join().when(this.continuation)},P.prototype.run=function(){var t=this.handler.consumers;if(void 0!==t)for(var e,n=0;n<t.length;++n)e=t[n],F(e.progress,this.value,this.handler,e.receiver,e.resolver)},R.prototype.run=function(){function t(t){r.resolve(t)}function e(t){r.reject(t)}function n(t){r.notify(t)}var r=this.resolver;q(this._then,this.thenable,t,e,n)},D.prototype.fulfilled=function(t){this.f.call(this.c,this.z,t,this.to)},D.prototype.rejected=function(t){this.to.reject(t)},D.prototype.progress=function(t){this.to.notify(t)},n}})}("function"==typeof define&&define.amd?define:function(t){e.exports=t()})}).call(this,t("_process"))},{_process:4}],61:[function(t,e,n){!function(t){"use strict";t(function(){function t(){return{state:"pending"}}function e(t){return{state:"rejected",reason:t}}function n(t){return{state:"fulfilled",value:t}}function r(r){var i=r.state();return 0===i?t():i>0?n(r.value):e(r.value)}return{pending:t,fulfilled:n,rejected:e,inspect:r}})}("function"==typeof define&&define.amd?define:function(t){e.exports=t()})},{}],62:[function(t,e,n){!function(t){"use strict";t(function(t){function e(t,e,n,r){var i=j.resolve(t);return arguments.length<2?i:i.then(e,n,r)}function n(t){return new j(t)}function r(t){return function(){for(var e=0,n=arguments.length,r=new Array(n);n>e;++e)r[e]=arguments[e];return E(t,this,r)}}function i(t){for(var e=0,n=arguments.length-1,r=new Array(n);n>e;++e)r[e]=arguments[e+1];return E(t,this,r)}function o(){return new u}function u(){function t(t){r._handler.resolve(t)}function e(t){r._handler.reject(t)}function n(t){r._handler.notify(t)}var r=j._defer();this.promise=r,this.resolve=t,this.reject=e,this.notify=n,this.resolver={resolve:t,reject:e,notify:n}}function c(t){return t&&"function"==typeof t.then}function s(){return j.all(arguments)}function a(t){return e(t,j.all)}function f(t){return e(t,j.settle)}function l(t,n){return e(t,function(t){return j.map(t,n)})}function p(t,n){return e(t,function(t){return j.filter(t,n)})}var d=t("./lib/decorators/timed"),h=t("./lib/decorators/array"),y=t("./lib/decorators/flow"),m=t("./lib/decorators/fold"),v=t("./lib/decorators/inspect"),g=t("./lib/decorators/iterate"),b=t("./lib/decorators/progress"),w=t("./lib/decorators/with"),x=t("./lib/decorators/unhandledRejection"),_=t("./lib/TimeoutError"),j=[h,y,m,g,b,v,w,d,x].reduce(function(t,e){return e(t)},t("./lib/Promise")),E=t("./lib/apply")(j);return e.promise=n,e.resolve=j.resolve,e.reject=j.reject,e.lift=r,e["try"]=i,e.attempt=i,e.iterate=j.iterate,e.unfold=j.unfold,e.join=s,e.all=a,e.settle=f,e.any=r(j.any),e.some=r(j.some),e.race=r(j.race),e.map=l,e.filter=p,e.reduce=r(j.reduce),e.reduceRight=r(j.reduceRight),e.isPromiseLike=c,e.Promise=j,e.defer=o,e.TimeoutError=_,e})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"./lib/Promise":45,"./lib/TimeoutError":47,"./lib/apply":48,"./lib/decorators/array":49,"./lib/decorators/flow":50,"./lib/decorators/fold":51,"./lib/decorators/inspect":52,"./lib/decorators/iterate":53,"./lib/decorators/progress":54,"./lib/decorators/timed":55,"./lib/decorators/unhandledRejection":56,"./lib/decorators/with":57}],63:[function(t,e,n){!function(t){"use strict";t(function(){return{findProperties:function t(e,n,r){"object"==typeof e&&null!==e&&(n in e&&r(e[n],e,n),Object.keys(e).forEach(function(i){t(e[i],n,r)}))}}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{}],64:[function(t,e,n){!function(t){"use strict";t(function(t){function e(t){var e,r,i,o,u;return e=n.defer(),r=!1,i=e.resolver,o=e.promise,u=o.then,o.then=function(){return r||(r=!0,n.attempt(t).then(i.resolve,i.reject)),u.apply(o,arguments)},o}var n;return n=t("when"),e})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{when:62}],65:[function(t,e,n){!function(t){"use strict";t(function(){function t(t){var n,r,i,o;for(t||(t={}),n=1,r=arguments.length;r>n;n+=1){i=arguments[n];for(o in i)o in t&&(t[o]===i[o]||o in e&&e[o]===i[o])||(t[o]=i[o])}return t}var e={};return t})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{}],66:[function(t,e,n){!function(t){"use strict";t(function(){function t(t){return t.toLowerCase().split("-").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join("-")}return t})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{}],67:[function(t,e,n){!function(t){"use strict";t(function(t){function e(t,e){return t.then(function(t){return t&&t[e]},function(t){return a.reject(t&&t[e])})}function n(){return e(this,"entity")}function r(){return e(e(this,"status"),"code")}function i(){return e(this,"headers")}function o(t){return t=f(t),e(this.headers(),t)}function u(t){return t=[].concat(t),c(a.reduce(t,function(t,e){if("string"==typeof e&&(e={rel:e}),"function"!=typeof t.entity.clientFor)throw new Error("Hypermedia response expected");var n=t.entity.clientFor(e.rel);return n({params:e.params})},this))}function c(t){return t.status=r,t.headers=i,t.header=o,t.entity=n,t.follow=u,t}function s(){return c(a.apply(a,arguments))}var a=t("when"),f=t("./normalizeHeaderName");return s.make=c,s.reject=function(t){return c(a.reject(t))},s.promise=function(t){return c(a.promise(t))},s})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"./normalizeHeaderName":66,when:62}],68:[function(t,e,n){!function(t){"use strict";t(function(){function t(t,e){if("string"!=typeof t)throw new Error("String required for URL encoding");return t.split("").map(function(t){if(e.hasOwnProperty(t))return t;var n=t.charCodeAt(0);return 127>=n?"%"+n.toString(16).toUpperCase():encodeURIComponent(t).toUpperCase()}).join("")}function e(e){return e=e||r.unreserved,function(n){return t(n,e)}}function n(t){return decodeURIComponent(t)}var r;return r=function(){var t={alpha:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",digit:"0123456789"};return t.genDelims=":/?#[]@",t.subDelims="!$&'()*+,;=",t.reserved=t.genDelims+t.subDelims,t.unreserved=t.alpha+t.digit+"-._~",t.url=t.reserved+t.unreserved,t.scheme=t.alpha+t.digit+"+-.",t.userinfo=t.unreserved+t.subDelims+":",t.host=t.unreserved+t.subDelims,t.port=t.digit,t.pchar=t.unreserved+t.subDelims+":@",t.segment=t.pchar,t.path=t.segment+"/",t.query=t.pchar+"/?",t.fragment=t.pchar+"/?",Object.keys(t).reduce(function(e,n){return e[n]=t[n].split("").reduce(function(t,e){return t[e]=!0,t},{}),e},{})}(),{decode:n,encode:e(),encodeURL:e(r.url),encodeScheme:e(r.scheme),encodeUserInfo:e(r.userinfo),encodeHost:e(r.host),encodePort:e(r.port),encodePathSegment:e(r.segment),encodePath:e(r.path),encodeQuery:e(r.query),encodeFragment:e(r.fragment)}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{}],69:[function(t,e,n){!function(t){"use strict";var e;t(function(t){function n(t,n,r){return n.split(",").reduce(function(n,i){var u,s;if(u={},"*"===i.slice(-1)&&(i=i.slice(0,-1),u.explode=!0),c.test(i)){var a=c.exec(i);i=a[1],u.maxLength=parseInt(a[2])}return i=o.decode(i),s=r[i],s===e||null===s?n:(Array.isArray(s)?n+=s.reduce(function(e,n){return e.length?(e+=u.explode?t.separator:",",t.named&&u.explode&&(e+=t.encoder(i),e+=n.length?"=":t.empty)):(e+=t.first,t.named&&(e+=t.encoder(i),e+=n.length?"=":t.empty)),e+=t.encoder(n)},""):"object"==typeof s?n+=Object.keys(s).reduce(function(e,n){return e.length?e+=u.explode?t.separator:",":(e+=t.first,t.named&&!u.explode&&(e+=t.encoder(i),e+=s[n].length?"=":t.empty)),e+=t.encoder(n),e+=u.explode?"=":",",e+=t.encoder(s[n])},""):(s=String(s),u.maxLength&&(s=s.slice(0,u.maxLength)),n+=n.length?t.separator:t.first,t.named&&(n+=t.encoder(i),n+=s.length?"=":t.empty),n+=t.encoder(s)),n)},"")}function r(t,e){var r;if(r=u[t.slice(0,1)],r?t=t.slice(1):r=u[""],r.reserved)throw new Error("Reserved expression operations are not supported");return n(r,t,e)}function i(t,e){var n,i,o;for(o="",i=0;;){if(n=t.indexOf("{",i),-1===n){o+=t.slice(i);break}o+=t.slice(i,n),i=t.indexOf("}",n)+1,o+=r(t.slice(n+1,i-1),e);
}return o}var o,u,c;return o=t("./uriEncoder"),c=/^([^:]*):([0-9]+)$/,u={"":{first:"",separator:",",named:!1,empty:"",encoder:o.encode},"+":{first:"",separator:",",named:!1,empty:"",encoder:o.encodeURL},"#":{first:"#",separator:",",named:!1,empty:"",encoder:o.encodeURL},".":{first:".",separator:".",named:!1,empty:"",encoder:o.encode},"/":{first:"/",separator:"/",named:!1,empty:"",encoder:o.encode},";":{first:";",separator:";",named:!0,empty:"",encoder:o.encode},"?":{first:"?",separator:"&",named:!0,empty:"=",encoder:o.encode},"&":{first:"&",separator:"&",named:!0,empty:"=",encoder:o.encode},"=":{reserved:!0},",":{reserved:!0},"!":{reserved:!0},"@":{reserved:!0},"|":{reserved:!0}},{expand:i}})}("function"==typeof define&&define.amd?define:function(n){e.exports=n(t)})},{"./uriEncoder":68}],70:[function(t,e,n){"use strict";function r(t,e,n){return new i(t,e,n)}var i=t("./src/suggestions");window.Suggestions=e.exports=r},{"./src/suggestions":74}],71:[function(t,e,n){!function(){var t=this,r={};"undefined"!=typeof n?e.exports=r:t.fuzzy=r,r.simpleFilter=function(t,e){return e.filter(function(e){return r.test(t,e)})},r.test=function(t,e){return null!==r.match(t,e)},r.match=function(t,e,n){n=n||{};var r,i=0,o=[],u=e.length,c=0,s=0,a=n.pre||"",f=n.post||"",l=n.caseSensitive&&e||e.toLowerCase();t=n.caseSensitive&&t||t.toLowerCase();for(var p=0;u>p;p++)r=e[p],l[p]===t[i]?(r=a+r+f,i+=1,s+=1+s):s=0,c+=s,o[o.length]=r;return i===t.length?{rendered:o.join(""),score:c}:null},r.filter=function(t,e,n){return n=n||{},e.reduce(function(e,i,o,u){var c=i;n.extract&&(c=n.extract(i));var s=r.match(t,c,n);return null!=s&&(e[e.length]={string:s.rendered,score:s.score,index:o,original:i}),e},[]).sort(function(t,e){var n=e.score-t.score;return n?n:t.index-e.index})}}()},{}],72:[function(t,e,n){function r(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)i.call(n,r)&&(t[r]=n[r])}return t}e.exports=r;var i=Object.prototype.hasOwnProperty},{}],73:[function(t,e,n){"Use strict";var r=function(t){return this.component=t,this.items=[],this.active=0,this.element=document.createElement("ul"),this.element.className="suggestions",t.el.parentNode.insertBefore(this.element,t.el.nextSibling),this};r.prototype.show=function(){this.element.style.display="block"},r.prototype.hide=function(){this.element.style.display="none"},r.prototype.add=function(t){this.items.push(t)},r.prototype.clear=function(){this.items=[],this.active=0},r.prototype.isEmpty=function(){return 0===this.element.children.length},r.prototype.draw=function(){if(this.element.innerHTML="",0===this.items.length)return void this.hide();for(var t=0;t<this.items.length;t++)this.drawItem(this.items[t],this.active===t);this.show()},r.prototype.drawItem=function(t,e){var n=document.createElement("li"),r=document.createElement("a");e&&(n.className+=" active"),r.innerHTML=t.string,n.appendChild(r),this.element.appendChild(n),n.addEventListener("mousedown",function(){this.handleMouseDown.call(this,t)}.bind(this))},r.prototype.handleMouseDown=function(t){this.component.value(t),this.clear(),this.draw()},r.prototype.move=function(t){this.active=t,this.draw()},r.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},r.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},e.exports=r},{}],74:[function(t,e,n){"use strict";var r=t("xtend"),i=t("fuzzy"),o=t("./list"),u=function(t,e,n){return n=n||{},this.options=r({minLength:2,limit:5},n),this.el=t,this.data=e||[],this.list=new o(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(t){this.handleKeyUp(t.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(t){this.handleKeyDown(t)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this};u.prototype.handleKeyUp=function(t){return 40!==t&&38!==t&&27!==t&&13!==t&&9!==t?(this.query=this.normalize(this.el.value),this.list.clear(),this.query.length<this.options.minLength?void this.list.draw():void this.getCandidates(function(t){for(var e=0;e<t.length&&(this.list.add(t[e]),e!==this.options.limit-1);e++);this.list.draw()}.bind(this))):void 0},u.prototype.handleKeyDown=function(t){switch(t.keyCode){case 13:case 9:this.list.isEmpty()||(this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},u.prototype.handleBlur=function(){this.list.hide()},u.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show()},u.prototype.update=function(t){this.data=t},u.prototype.normalize=function(t){return t=t.toLowerCase()},u.prototype.match=function(t,e){return t.indexOf(e)>-1},u.prototype.value=function(t){if(this.selected=t,this.el.value=this.getItemValue(t),document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1),this.el.dispatchEvent(e)}else this.el.fireEvent("onchange")},u.prototype.getCandidates=function(t){var e={pre:"<strong>",post:"</strong>",extract:function(t){return this.getItemValue(t)}.bind(this)},n=i.filter(this.query,this.data,e);t(n)},u.prototype.getItemValue=function(t){return t},e.exports=u},{"./list":73,fuzzy:71,xtend:72}],75:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var u=t("mapbox/lib/services/geocoder"),c=r(u),s=t("suggestions"),a=r(s),f=t("lodash.assign"),l=r(f),p=t("lodash.debounce"),d=r(p),h=function(t){function e(n){i(this,e),t.call(this),this.options={position:"top-left",proximity:null},this._ev=[],this.options=l["default"](this.options,n)}return o(e,t),e.prototype.onAdd=function(t){var e=this;this.container=this.options.container?"string"==typeof this.options.container?document.getElementById(this.options.container):this.options.container:t.getContainer();var n=document.createElement("div");n.className="mapboxgl-ctrl-geocoder";var r=document.createElement("span");r.classList.add("geocoder-icon","geocoder-icon-search");var i=this._inputEl=document.createElement("input");i.type="text",i.placeholder="Search",i.addEventListener("keypress",d["default"](function(t){e._queryInput(t.target.value)}),100),i.addEventListener("change",function(){if(e._typeahead.selected){var n=e._typeahead.selected;t.flyTo({center:n.center}),e.fire("geocoder.input",{feature:n}),e._input=n}});var o=document.createElement("div");o.classList.add("geocoder-pin-right");var u=this._clearEl=document.createElement("button");u.classList.add("geocoder-icon","geocoder-icon-close"),u.addEventListener("click",this._clear.bind(this));var s=this._loadingEl=document.createElement("span");return s.classList.add("geocoder-icon","geocoder-icon-loading"),o.appendChild(u),o.appendChild(s),n.appendChild(r),n.appendChild(i),n.appendChild(o),this.container.appendChild(n),this.client=new c["default"](this.options.accessToken?this.options.accessToken:mapboxgl.accessToken),this.options.container&&(this.options.position=!1),this._typeahead=new a["default"](i,[]),this._typeahead.getItemValue=function(t){return t.place_name},n},e.prototype._geocode=function(t,e){var n=this;this._loadingEl.classList.toggle("active",!0),this.fire("geocoder.loading");var r=this.options.proximity?{proximity:{longitude:this.options.proximity[0],latitude:this.options.proximity[1]}}:{};return this.client.geocodeForward(t.trim(),r,function(t,r){if(t)throw t;n._loadingEl.classList.toggle("active",!1),r.features.length||(n._typeahead.selected=null),n._typeahead.update(r.features),n._clearEl.classList.toggle("active",r.features.length);var i=document.createEvent("HTMLEvents");return i.initEvent("change",!0,!1),e(r.features)})},e.prototype._queryInput=function(t){var e=this;this._geocode(t,function(n){e._results=n,e._query=t})},e.prototype._query=function(t){var e="string"==typeof t?t:t.join();this._geocode(e,function(t){!t.length})},e.prototype._clear=function(){this._input=null,this._inputEl.value="",this.fire("geocoder.clear")},e.prototype.getInput=function(){return this._input},e.prototype.setInput=function(t){return this._query(t),this},e.prototype.on=function(t,e){return this._ev[t]=this._ev[t]||[],this._ev[t].push(e),this},e.prototype.fire=function(t,e){if(this._ev[t]){for(var n=this._ev[t].slice(),r=0;r<n.length;r++)n[r].call(this,e);return this}},e}(mapboxgl.Control);n["default"]=h,e.exports=n["default"]},{"lodash.assign":7,"lodash.debounce":18,"mapbox/lib/services/geocoder":26,suggestions:70}]},{},[1]);
